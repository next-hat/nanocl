Type: Deployment
ApiVersion: v0.2

Namespace: global

Resources:
- Name: deploy-example.com
  Kind: ProxyRule
  Version: v0.1
  Config:
    Watch:
    - deploy-example.global
    - deploy-example2.global
    Rule:
      Http:
        Domain: deploy-example.com
        Network: Public
        Locations:
        - Path: /
          Target:
            Http:
              Url: http://deploy-example.com/v2
              Redirect: TemporaryRedirect

        - Path: /v2
          Target:
            Cargo:
              Key: deploy-example2.global
              Port: 9000

Cargoes:
- Name: deploy-example
  # See all options:
  # https://docs.docker.com/engine/api/v1.42/#tag/Container/operation/ContainerCreate
  Container:
    Image: nexthat/nanocl-get-started:latest
    Env:
      - APP=GET_STARTED1

- Name: deploy-example2
  # See all options:
  # https://docs.docker.com/engine/api/v1.42/#tag/Container/operation/ContainerCreate
  Container:
    Image: nexthat/nanocl-get-started:latest
    Env:
      - APP=GET_STARTED2
